(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{"8cdb":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{attrs:{fluid:"","fill-height":""}},[s("v-layout",{attrs:{"align-center":"","justify-center":""}},[s("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[s("v-card",{staticClass:"elevation-12"},[s("v-toolbar",{attrs:{dark:"",color:"error"}},[s("v-toolbar-title",[t._v("Error 404 - page not found.")])],1),s("br"),s("br"),s("br"),s("br"),s("v-card-actions",[t.user?t._e():s("v-btn",{attrs:{color:"primary",to:"/login"}},[t._v("Login")]),t.user?t._e():s("v-btn",{attrs:{color:"primary",to:"/register"}},[t._v("Register")]),t.user?s("v-btn",{attrs:{color:"primary",to:"/restaurants"}},[t._v("View restaurants")]):t._e()],1),s("br")],1)],1)],1)],1)},a=[],i=s("cebc"),o=s("2f62"),l={name:"error",computed:Object(i["a"])({},Object(o["b"])({user:"users/getUser"}))},n=l,c=s("2877"),u=s("6544"),d=s.n(u),v=s("8336"),f=s("b0af"),p=s("99d9"),h=s("a523"),m=s("0e8f"),g=s("a722"),b=s("71d9"),x=s("2a7f"),_=Object(c["a"])(n,r,a,!1,null,null,null);e["default"]=_.exports;d()(_,{VBtn:v["a"],VCard:f["a"],VCardActions:p["a"],VContainer:h["a"],VFlex:m["a"],VLayout:g["a"],VToolbar:b["a"],VToolbarTitle:x["a"]})},ed81:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("list",{attrs:{tb2:t.pages>1||t.user&&"user"!==t.user.role,tb3:t.pages>1}},[s("template",{slot:"toolbar-primary"},[t.users&&t.users.length?[s("v-flex",{attrs:{xs12:"",sm3:""}},[s("v-toolbar-title",[t._v("\n          Users\n        ")])],1),s("v-flex",{attrs:{xs12:"",sm3:"","offset-sm1":""}},[s("v-select",{attrs:{items:t.sortItems,dense:"",flat:"",height:"22","append-icon":"sort"},on:{change:t.changeRoute},model:{value:t.sorted,callback:function(e){t.sorted=e},expression:"sorted"}})],1),s("v-flex",{attrs:{xs12:"",sm4:"","offset-sm1":""}},[s("v-select",{attrs:{items:t.filterItems,dense:"",flat:"",height:"22","append-icon":"filter_list"},on:{change:t.changeRoute},model:{value:t.filtered,callback:function(e){t.filtered=e},expression:"filtered"}})],1)]:t.loading?s("v-flex",{attrs:{xs12:""}},[s("v-progress-circular",{attrs:{indeterminate:"",color:"#fff"}})],1):s("v-flex",{attrs:{xs12:""}},[s("v-toolbar-title",[t._v("No users found.")])],1)],2),s("template",{slot:"toolbar-secondary"},[s("v-flex",{attrs:{xs8:""}},[t.pages>1?s("v-pagination",{attrs:{length:t.pages},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}):t._e()],1),s("v-flex",{attrs:{xs3:"","offset-xs1":""}},[s("v-dialog",{staticClass:"right",attrs:{width:"280",light:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t.users&&t.users.length?s("v-btn",{staticClass:"right mr-0",attrs:{slot:"activator",color:"error",small:"",outline:""},slot:"activator"},[t._v("remove all")]):t._e(),s("v-card",[s("v-card-text",[t._v("\n            Remove ALL USERS from database?\n          ")]),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"tertiary",flat:"flat"},on:{click:function(e){t.dialog=!1}}},[t._v("\n              Cancel\n            ")]),s("v-btn",{attrs:{color:"secondary",flat:"flat"},on:{click:t.submitDelete}},[t._v("\n              confirm\n            ")])],1)],1)],1)],1)],1),s("template",{slot:"list"},[s("v-list",{attrs:{"two-line":""}},t._l(t.slicedUsers,function(t){return s("user",{key:t._id,attrs:{user:t}})}),1)],1),s("template",{slot:"toolbar-tertiary"},[s("v-flex",{attrs:{xs12:""}},[s("v-pagination",{attrs:{length:t.pages},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)],1)],2)},a=[],i=(s("a481"),s("55dd"),s("cebc")),o=s("2b0e"),l=s("2e90"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-list-tile",{staticClass:"py-2 px-0 mx-4"},[s("v-layout",{attrs:{wrap:""}},[t.edit?s("v-flex",{attrs:{xs12:""}},[s("v-form",{ref:"form"},[s("v-text-field",{attrs:{placeholder:t.user.email,name:"email",rules:t.emailRules,type:"email","validate-on-blur":""},model:{value:t.email,callback:function(e){t.email="string"===typeof e?e.trim():e},expression:"email"}}),s("v-text-field",{attrs:{placeholder:t.user.password,name:"password",rules:t.passwordRules,counter:64,type:"password","validate-on-blur":""},model:{value:t.password,callback:function(e){t.password="string"===typeof e?e.trim():e},expression:"password"}}),s("v-select",{attrs:{placeholder:t.user.role,items:t.roles},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}}),s("v-btn",{staticClass:"left",attrs:{color:"secondary"},on:{click:t.submitEdit}},[t._v("Submit")]),s("v-btn",{attrs:{color:"tertiary"},on:{click:function(e){t.edit=!1,t.email="",t.password="",t.role=""}}},[t._v("Cancel")]),s("v-btn",{staticClass:"left",attrs:{color:"tertiary"},on:{click:function(e){t.email="",t.password="",t.role=""}}},[t._v("Clear")])],1)],1):[s("v-flex",{attrs:{xs8:""}},[s("v-list-tile-content",[s("v-list-tile-title",[t._v("\n            E-mail: "+t._s(t.user.email)+"\n            "),t.isSelf?s("span",{staticClass:"title ml-5 info--text"},[t._v("(me)")]):t._e()]),s("v-list-tile-sub-title",[t._v("Password: "+t._s(t.user.password))]),s("v-list-tile-sub-title",{staticClass:"accent--text"},[t._v("Role: "+t._s(t.user.role))])],1)],1),s("v-flex",{attrs:{xs3:"","offset-xs1":""}},[s("v-dialog",{staticClass:"right",attrs:{width:"280",light:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-btn",{staticClass:"right mr-0",attrs:{slot:"activator",color:"error",fab:"",small:"",outline:""},slot:"activator"},[s("v-icon",[t._v("close")])],1),s("v-card",[s("v-card-text",[t.isSelf?s("span",[t._v("\n                Are you sure you want to remove "),s("span",{staticClass:"error--text"},[t._v("yourself")]),t._v(" from the database?\n              ")]):s("span",[t._v("\n                Remove user "+t._s(t.user.email)+" from database?\n              ")])]),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"tertiary",flat:"flat"},on:{click:function(e){t.dialog=!1}}},[t._v("\n                Cancel\n              ")]),s("v-btn",{attrs:{color:"secondary",flat:"flat"},on:{click:t.submitDelete}},[t._v("\n                confirm\n              ")])],1)],1)],1),s("v-tooltip",{attrs:{top:"",color:"dark",lazy:""}},[s("v-btn",{staticClass:"right mr-0",attrs:{slot:"activator",color:"secondary",fab:"",small:"",depressed:""},on:{click:function(e){t.edit=!t.edit}},slot:"activator"},[s("v-icon",[t._v("edit")])],1),s("span",[t._v("Edit this user")])],1)],1)]],2)],1)},c=[],u=s("1dce"),d=s("b5ae"),v=s("2f62"),f={name:"restaurant-list",mixins:[u["validationMixin"]],validations:{email:{email:d["email"]},password:{minLength:Object(d["minLength"])(8),maxLength:Object(d["maxLength"])(64)}},data:function(){var t=this;return{emailRules:[function(){return!!t.$v.email.email||"Must be valid e-mail."}],passwordRules:[function(){return!(!t.$v.password.minLength||!t.$v.password.maxLength)||"Password must contain 8 to 64 characters."}],dialog:!1,edit:!1,email:"",password:"",role:"",roles:[{value:"",disabled:!0,text:"Role"},"admin","owner","user"]}},props:{user:{type:Object,required:!0}},computed:Object(i["a"])({},Object(v["b"])({currentUser:"users/getUser"}),{isSelf:function(){return!!this.currentUser&&this.currentUser._id===this.user._id}}),methods:{submitDelete:function(){var t=this;this.$store.dispatch("users/removeUser",this.user._id).then(function(){return!t.isSelf||t.logout()})},submitEdit:function(){var t=this;if(!this.$v.$invalid){var e=this.user;this.$store.dispatch("users/updateUser",{_id:e._id,email:this.email||e.email,password:this.password||e.password,role:this.role||e.role}).then(function(){t.edit=!1,t.$store.dispatch("users/fetchUsers").then(function(){return!t.isSelf||t.logout()})})}},logout:function(){this.$store.dispatch("users/logout"),this.$router.replace(this.$route.query.redirect||"/login")}}},p=f,h=s("2877"),m=s("6544"),g=s.n(m),b=s("8336"),x=s("b0af"),_=s("99d9"),V=s("169a"),w=s("0e8f"),y=s("4bd4"),C=s("132d"),k=s("a722"),U=s("ba95"),$=s("5d23"),T=s("b56d"),L=s("9910"),R=s("2677"),j=s("3a2f"),S=Object(h["a"])(p,n,c,!1,null,null,null),O=S.exports;g()(S,{VBtn:b["a"],VCard:x["a"],VCardActions:_["a"],VCardText:_["b"],VDialog:V["a"],VFlex:w["a"],VForm:y["a"],VIcon:C["a"],VLayout:k["a"],VListTile:U["a"],VListTileContent:$["a"],VListTileSubTitle:$["b"],VListTileTitle:$["c"],VSelect:T["a"],VSpacer:L["a"],VTextField:R["a"],VTooltip:j["a"]});var E=s("30c1"),A={name:"users",components:{list:l["a"],user:O},data:function(){return{loading:!0,sortItems:[{text:"E-mail: A-Z",value:"az"},{text:"Created",value:"created"},{text:"Role",value:"role"}],filterItems:[{text:"Filter by role",value:"",disabled:!0},{text:"Show all",value:" "},{text:"Admin",value:"admin"},{text:"Owner",value:"owner"},{text:"Regular User",value:"user"}],sorted:"created",filtered:"",page:1,pp:10,dialog:!1,silent:!1}},computed:Object(i["a"])({},Object(v["b"])({user:"users/getUser",users:"users/getUsers"}),{sortedUsers:function(){var t=this.filtered,e=this.sorted;return this.users.concat().filter(function(e){return!t||e.role===t||" "===t}).sort(function(t,s){return"created"===e?t[e]>s[e]?-1:1:t[e]>s[e]?1:-1})},slicedUsers:function(){var t=this.pp*(this.page-1);return this.sortedUsers.slice(t,t+this.pp)},count:function(){return this.sortedUsers.length},pages:function(){return Math.ceil(this.count/this.pp)}}),methods:{fetchUsers:function(t){var e=this;if(!this.silent){if(t){var s=t.query;this.query=s,s.sort&&(this.sorted=s.sort),s.role&&(this.filtered=s.role),s.page&&(this.page=1*s.page)}this.loading=!0,this.$store.dispatch("users/fetchUsers").then(function(){return e.loading=!1})}},submitDelete:function(){var t=this;this.$store.dispatch("users/removeUsers").then(function(){return t.dialog=!1}).then(function(){return t.logout()})},logout:function(){this.$store.dispatch("users/logout"),this.$router.replace(this.$route.query.redirect||"/login")},adjustPage:function(){this.count<=(this.page-1)*this.pp&&(this.page=Math.floor(this.count/this.pp)+1)},changeRoute:function(){var t=this;this.silent=!0,o["a"].nextTick(function(){t.adjustPage();var e="sort=".concat(t.sorted),s="role=".concat(t.filtered),r="page=".concat(t.page);t.$router.push("/users?".concat(e,"&").concat(s,"&").concat(r)),o["a"].nextTick(function(){return t.silent=!1})})}},watch:{$route:"fetchUsers",page:"changeRoute"},mounted:function(){this.fetchUsers(this.$route),E["default"].$on("DB:updated:restaurants",this.fetchUsers())}},D=A,F=s("8860"),P=s("891e"),q=s("490a"),I=s("2a7f"),B=Object(h["a"])(D,r,a,!1,null,null,null);e["default"]=B.exports;g()(B,{VBtn:b["a"],VCard:x["a"],VCardActions:_["a"],VCardText:_["b"],VDialog:V["a"],VFlex:w["a"],VList:F["a"],VPagination:P["a"],VProgressCircular:q["a"],VSelect:T["a"],VSpacer:L["a"],VToolbarTitle:I["a"]})}}]);
//# sourceMappingURL=users.660c2fb3.js.map